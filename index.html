<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì¹´ë“œ ë’¤ì§‘ê¸° ê²Œì„</title>
<style>
    :root {
        --primary-color: #1e3c72;
        --accent-color: #ffd700;
        --bg-color: #f4f6f9;
    }

    body {
        font-family: 'Pretendard', sans-serif;
        background-color: var(--bg-color);
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 40px 10px;
        margin: 0;
        min-height: 100vh;
    }

    /* ì»¨íŠ¸ë¡¤ ì˜ì—­ (ë‹¨ê³„ ë²„íŠ¼ + ì„ê¸° ë²„íŠ¼) */
    .controls {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
    }

    .stage-nav {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        justify-content: center;
    }

    .stage-btn {
        padding: 10px 20px;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 50px;
        cursor: pointer;
        font-size: 0.95rem;
        color: #666;
        transition: all 0.2s;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .stage-btn:hover { background-color: #f9f9f9; color: #333; }
    .stage-btn.active {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
        font-weight: bold;
        box-shadow: 0 4px 10px rgba(30, 60, 114, 0.3);
    }

    /* ì„ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .shuffle-btn {
        padding: 12px 30px;
        background-color: #333;
        color: #fff;
        border: none;
        border-radius: 50px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: transform 0.2s, background-color 0.2s;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .shuffle-btn:hover { background-color: #555; transform: translateY(-2px); }
    .shuffle-btn:active { transform: scale(0.95); }

    /* ê²Œì„ ë³´ë“œ */
    .game-board {
        display: grid;
        gap: 8px;
        width: 100%;
        max-width: 900px;
        perspective: 1000px;
        margin: 0 auto 40px auto;
    }

    .game-board[data-stage="1"] { grid-template-columns: repeat(5, 1fr); max-width: 600px; }
    .game-board[data-stage="2"] { grid-template-columns: repeat(5, 1fr); max-width: 700px; }
    .game-board[data-stage="3"] { grid-template-columns: repeat(8, 1fr); max-width: 900px; }
    .game-board[data-stage="4"] { grid-template-columns: repeat(10, 1fr); max-width: 1000px; }

    .card {
        background-color: transparent;
        position: relative;
        cursor: pointer;
        aspect-ratio: 3 / 4; 
        transform-style: preserve-3d;
        transition: transform 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
        border-radius: 10px;
    }

    .card-face {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        backface-visibility: hidden;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        font-weight: bold;
        overflow: hidden; 
    }

    .card-front {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: rgba(255,255,255,0.2);
        font-size: 1.5rem;
        border: 2px solid white;
    }
    .card-front::after { content: 'â˜…'; }

    .card-back {
        background-color: white;
        transform: rotateY(180deg);
        border: 2px solid #eee;
        padding: 0; 
    }

    .card-back img {
        width: 100%;
        height: 100%;
        object-fit: cover; 
        display: block;
    }

    .card.flipped { transform: rotateY(180deg); cursor: default; }
    
    .card.matched {
        transform: rotateY(180deg);
        cursor: default;
        border: 3px solid var(--accent-color);
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        animation: popEffect 0.4s ease-out;
    }

    @keyframes popEffect {
        0% { transform: rotateY(180deg) scale(1); }
        50% { transform: rotateY(180deg) scale(1.1); }
        100% { transform: rotateY(180deg) scale(1); }
    }

    /* ì…”í”Œ ì• ë‹ˆë©”ì´ì…˜ */
    .card.shuffling { animation: shuffleMix 0.6s ease-in-out; pointer-events: none; }
    @keyframes shuffleMix {
        0% { transform: scale(1); }
        50% { transform: scale(0.5) translateY(-30px); z-index: 100; } /* ì‚´ì§ ëœ¨ë©´ì„œ ì‘ì•„ì§ */
        100% { transform: scale(1); }
    }

    @media (max-width: 768px) {
        .game-board { gap: 5px; padding: 0 10px; }
        .game-board[data-stage="1"] { grid-template-columns: repeat(4, 1fr); }
        .game-board[data-stage="2"] { grid-template-columns: repeat(4, 1fr); }
        .game-board[data-stage="3"] { grid-template-columns: repeat(5, 1fr); }
        .game-board[data-stage="4"] { grid-template-columns: repeat(6, 1fr); }
    }
</style>
</head>
<body>

    <div class="controls">
        <nav class="stage-nav">
            <button class="stage-btn active" onclick="setStage(1)">1ë‹¨ê³„ (10ì¥)</button>
            <button class="stage-btn" onclick="setStage(2)">2ë‹¨ê³„ (20ì¥)</button>
            <button class="stage-btn" onclick="setStage(3)">3ë‹¨ê³„ (40ì¥)</button>
            <button class="stage-btn" onclick="setStage(4)">4ë‹¨ê³„ (60ì¥)</button>
        </nav>
        
        <button class="shuffle-btn" onclick="shuffleBoard()">
            ğŸ”€ ì¹´ë“œ ì„ê¸°
        </button>
    </div>

    <div class="game-board" id="gameBoard" data-stage="1"></div>

<script>
    const imgUrls = [
        "https://i.ibb.co/nHssMmS/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/YFRpkN29/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/YBBh5BQb/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/WN0YSjpQ/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/VWK2r0ns/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/NgSqKjcV/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/SDBYcS69/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/nNR8G4wN/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/C3Xwnw7B/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/dwgYRL3w/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/G39JHfYP/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/cX7Ph3P8/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/VcGrZdw8/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/wZsFH5jd/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/hJdcLQt4/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/bjjKpPNt/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/MxnzX2Zb/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/Fq5Q1Z4x/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/hJYKqKfq/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/sdWrMVWj/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/s9L3QWrK/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/qFXhMsJB/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/gZSnVKGY/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/G4Sw4FXR/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/bj1ZgXDb/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/5x9jRYcL/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/MkxkNMT1/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/9xSN0px/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/5xFbpsvx/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/3yNn17tS/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png",
        "https://i.ibb.co/rG0NJTSJ/0-CGPK4s1-T2-AUebe-IYXx-Dmgv-Z5da-Uj-MAPj-Uwflj-MI3-Ndj-Qzs-Okurt3-K2g-Kci-x-MGYtx-Dnk-S9-K5-Pz-SZUWpnkk-R.png"
    ];

    const stageConfig = { 1: 10, 2: 20, 3: 40, 4: 60 };
    let currentStage = 1;
    let flippedCards = [];
    let matchedCount = 0;
    let isProcessing = false;

    setStage(1);

    function setStage(stage) {
        currentStage = stage;
        document.querySelectorAll('.stage-btn').forEach((btn, idx) => {
            btn.classList.toggle('active', idx + 1 === stage);
        });
        const board = document.getElementById('gameBoard');
        board.setAttribute('data-stage', stage);
        initGame();
    }

    function getRandomImages(count) {
        let pool = [...imgUrls]; 
        while (pool.length < count) {
            pool = pool.concat(imgUrls);
        }
        shuffleArray(pool);
        return pool.slice(0, count);
    }

    function initGame() {
        const board = document.getElementById('gameBoard');
        board.innerHTML = '';
        flippedCards = [];
        matchedCount = 0;
        isProcessing = false;

        const totalCards = stageConfig[currentStage];
        const pairsCount = totalCards / 2;
        
        const selectedImages = getRandomImages(pairsCount);
        let gameDeck = [...selectedImages, ...selectedImages];
        shuffleArray(gameDeck);

        gameDeck.forEach(imgUrl => {
            const card = document.createElement('div');
            card.classList.add('card');
            card.classList.add('shuffling');

            card.innerHTML = `
                <div class="card-face card-front"></div>
                <div class="card-face card-back">
                    <img src="${imgUrl}" alt="Game Card">
                </div>
            `;

            card.addEventListener('click', () => flipCard(card, imgUrl));
            board.appendChild(card);
        });

        setTimeout(() => {
            document.querySelectorAll('.card').forEach(c => c.classList.remove('shuffling'));
        }, 600);
    }

    // ì¹´ë“œ ìœ„ì¹˜ë§Œ ì„ëŠ” í•¨ìˆ˜
    function shuffleBoard() {
        if(isProcessing) return; // ì¹´ë“œ ë’¤ì§‘ëŠ” ì¤‘ì—” ì‘ë™ ì•ˆí•¨
        
        const board = document.getElementById('gameBoard');
        const cards = Array.from(board.children); // í˜„ì¬ ë³´ë“œì— ìˆëŠ” ì¹´ë“œë“¤ ê°€ì ¸ì˜¤ê¸°

        // 1. ì„ëŠ” ëª¨ì…˜ ì‹œì‘
        cards.forEach(card => card.classList.add('shuffling'));

        // 2. ëª¨ì…˜ ì¤‘ê°„(ì¹´ë“œê°€ ë­‰ì³¤ì„ ë•Œ)ì— ì‹¤ì œ ìœ„ì¹˜ ì´ë™
        setTimeout(() => {
            // ì¹´ë“œ ë°°ì—´ì„ ëœë¤í•˜ê²Œ ì„ìŒ
            shuffleArray(cards);
            
            // ì„ì¸ ìˆœì„œëŒ€ë¡œ ë³´ë“œì— ë‹¤ì‹œ ë¶™ì„ (ê¸°ì¡´ ìƒíƒœ ìœ ì§€ë¨)
            cards.forEach(card => board.appendChild(card));
        }, 300); // 0.3ì´ˆ ë’¤ ì‹¤í–‰

        // 3. ëª¨ì…˜ ì¢…ë£Œ
        setTimeout(() => {
            cards.forEach(card => card.classList.remove('shuffling'));
        }, 600);
    }

    function flipCard(card, imgUrl) {
        if (card.classList.contains('flipped') || isProcessing || card.classList.contains('matched')) {
            return;
        }

        card.classList.add('flipped');
        flippedCards.push({ card, imgUrl });

        if (flippedCards.length === 2) {
            checkForMatch();
        }
    }

    function checkForMatch() {
        isProcessing = true;
        const [first, second] = flippedCards;

        if (first.imgUrl === second.imgUrl) {
            setTimeout(() => {
                first.card.classList.add('matched');
                second.card.classList.add('matched');
                matchedCount++;
                flippedCards = [];
                isProcessing = false;

                if (matchedCount === stageConfig[currentStage] / 2) {
                    setTimeout(() => alert("ğŸ‰ ë¯¸ì…˜ ì„±ê³µ! ëª¨ë“  ì¹´ë“œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤!"), 300);
                }
            }, 200);
        } else {
            setTimeout(() => {
                first.card.classList.remove('flipped');
                second.card.classList.remove('flipped');
                flippedCards = [];
                isProcessing = false;
            }, 800);
        }
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }
</script>
</body>
</html>
